# Инструкция по настройке бота

## 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

## 2. Настройка переменных окружения

Скопируйте `.env.example` в `.env` и заполните все параметры:

```bash
cp .env.example .env
```

### Обязательные параметры:

- `BOT_TOKEN` - токен вашего Telegram бота (получить у @BotFather)
- `ADMIN_IDS` - список ID администраторов через запятую (например: `123456789,987654321`)
- `ROBOKASSA_MERCHANT_LOGIN` - логин мерчанта в Robokassa
- `ROBOKASSA_PASSWORD_1` - Пароль #1 в Robokassa (для генерации подписи)
- `ROBOKASSA_PASSWORD_2` - Пароль #2 в Robokassa (для проверки подписи)
- `CHANNEL_1_ID` - ID или username канала "Орден Демиургов" (например: `@orden_demiurgov` или `-1001234567890`)
- `CHANNEL_2_ID` - ID или username канала "Родители Демиурги" (например: `@roditeli_demiurgi` или `-1001234567890`)

### Опциональные параметры:

- `ROBOKASSA_TEST_MODE` - режим тестирования (True/False)
- `DATABASE_PATH` - путь к файлу базы данных (по умолчанию: `bot_database.db`)
- `SUPPORT_LINK` - ссылка на поддержку (по умолчанию: `https://t.me/lnhvvu`)
- `OFFER_LINK` - ссылка на договор оферты

## 3. Настройка Robokassa

1. В личном кабинете Robokassa настройте:

   - **Result URL**: `https://ваш-домен.com/robokassa/result`
   - **Success URL**: `https://ваш-домен.com/robokassa/success`
   - **Fail URL**: `https://ваш-домен.com/robokassa/fail`

2. Убедитесь, что ваш сервер доступен из интернета (используйте ngrok или аналогичный сервис для тестирования)

## 4. Настройка бота в Telegram

1. Добавьте бота в каналы как администратора с правами:

   - Добавление участников
   - Исключение участников

2. Убедитесь, что бот может добавлять и удалять пользователей из каналов

## 5. Запуск бота

```bash
python main.py
```

## 6. Использование админ-панели

### Импорт пользователей из мастер-класса:

```
/import_users 123456789 987654321 111222333
```

Где числа - это telegram_id пользователей, которых нужно импортировать.

## 7. Развертывание на сервере

Для production рекомендуется:

1. Использовать systemd или supervisor для автозапуска
2. Настроить reverse proxy (nginx) для webhook'ов
3. Использовать PostgreSQL вместо SQLite для базы данных
4. Настроить логирование
5. Использовать SSL сертификат для webhook'ов

## Примечания

- Бот автоматически проверяет напоминания каждый час
- Бот автоматически проверяет истекшие подписки каждые 6 часов
- Webhook сервер запускается на порту 8080 (можно изменить в `main.py`)
